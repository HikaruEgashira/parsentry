# 出力形式

Parsentry は LLM の解析結果を構造化された形式で出力します。

## 設計思想

### なぜ構造化出力か

- **一貫性**: 異なる脆弱性タイプでも統一された形式
- **自動処理**: CI/CD パイプラインや他ツールとの連携
- **追跡可能性**: コードとの明確な紐付け

### 出力の構成要素

| 要素 | 目的 |
|------|------|
| 思考プロセス | LLM の解析過程を可視化し、判断根拠を明確化 |
| 脆弱性説明 | 問題の本質、影響範囲、リスクを説明 |
| 概念実証 | 悪用可能性を実証し、誤検知を削減 |
| 信頼度 | 発見の確実性を定量化し、優先度付けを支援 |
| コード参照 | 該当箇所を特定し、修正を容易に |

## 思考プロセス（Scratchpad）

LLM が解析で辿った思考過程を記録します。

### 意図

- 「なぜこれが脆弱性なのか」の根拠を示す
- 誤検知時のデバッグを容易に
- 解析品質の評価基準を提供

### 典型的な内容

1. 入力ソースの特定
2. データフローの追跡
3. 検証の有無・妥当性の確認
4. 悪用シナリオの構築

## 信頼度スコア

脆弱性発見の確実性を数値で表現します。

### スコアの意味

| 範囲 | 解釈 |
|------|------|
| 低 | 可能性あり、追加調査が必要 |
| 中 | 脆弱である可能性が高い |
| 高 | 脆弱性を確認、PoC で実証済み |

### スコアに影響する要因

- コードの明確性（曖昧さがないか）
- データフローの追跡可能性
- 悪用の実現可能性
- 外部要因への依存度

## 概念実証（PoC）

脆弱性が実際に悪用可能であることを示すコードまたは手順です。

### 目的

- 誤検知の削減（動作する PoC は実際の脆弱性の証拠）
- 修正確認のテストケースとして活用
- 影響範囲の理解を支援

### 良い PoC の特徴

- 再現可能で具体的
- 最小限のステップで悪用を実証
- 期待される結果を明記

## コード参照

脆弱性に関連するコード箇所を特定します。

### 含まれる情報

- 関数・メソッド名
- 脆弱性との関連理由
- 該当コード行

### PAR との関連

コード参照は PAR 分類と紐付けられ、脆弱性の構造（どの Principal がどの Resource に影響するか）を明確にします。

## 脆弱性タイプ

検出された脆弱性を分類します。主なカテゴリ：

- インジェクション系（SQL、コマンド、コード）
- アクセス制御系（認証バイパス、権限昇格）
- データ漏洩系（情報露出、暗号化の欠如）
- 入力検証系（パストラバーサル、XSS）

分類により、修正の優先度付けや傾向分析が可能になります。
