# Prompt Engineering in vulnhuntrs

This document details the various prompt templates used to interact with the LLM for security analysis.

## 1. System Prompt (`SYS_PROMPT_TEMPLATE`)

- **File**: `src/prompts/analysis.rs`
- **Purpose**: Sets the overall context and role for the LLM (security researcher), outlines the focus areas (input validation, auth, data handling, etc.), and specifies the mandatory JSON output format including the required fields (`scratchpad`, `analysis`, `poc`, `confidence_score`, `vulnerability_types`, `context_code`).
- **Key Instructions**: Adhere strictly to the JSON schema, focus on security-critical patterns.

## 2. README Summary Prompt (`README_SUMMARY_PROMPT_TEMPLATE`)

- **File**: `src/prompts/analysis.rs`
- **Purpose**: Instructs the LLM to read the provided README content and generate a concise summary covering the project's purpose, features, technical details, and any security information.
- **Output Format**: The summary should be enclosed in `<summary></summary>` tags.

## 3. Initial Analysis Prompt (`INITIAL_ANALYSIS_PROMPT_TEMPLATE`)

- **File**: `src/prompts/analysis.rs`
- **Purpose**: Asks the LLM to perform a broad security analysis of the provided code, considering various vulnerability classes (input handling, auth, file ops, network, commands, DB queries).
- **Context Included**: Typically includes the README summary and the full source code of the file being analyzed.
- **Output Format**: Must follow the standard JSON schema defined in the System Prompt.

## 4. Vulnerability-Specific Prompts (`vuln_specific::VulnTypeInfo`)

- **File**: `src/prompts/analysis.rs` (within `vuln_specific` module)
- **Purpose**: Used for deep-dive analysis once a potential vulnerability type is identified (either by the initial analysis or other means). Each vulnerability type (LFI, RCE, SSRF, AFO, SQLI, XSS, IDOR) has a specific prompt template.
- **Content**: Contains tailored instructions to analyze for that specific vulnerability class.
- **Bypass Information**: Each `VulnTypeInfo` also includes a list of common bypass techniques for that vulnerability type, potentially guiding the LLM's analysis.
- **Output Format**: Must follow the standard JSON schema.

## 5. Analysis Approach & Guidelines (`ANALYSIS_APPROACH_TEMPLATE`, `GUIDELINES_TEMPLATE`)

- **File**: `src/prompts/analysis.rs`
- **Purpose**: These templates provide meta-instructions to the LLM on *how* to conduct the analysis (e.g., trace data flow, consider bypasses, evaluate impact) and general guidelines (e.g., focus on concrete vulns, provide code references, rate confidence).
- **Usage**: These are likely combined with other prompts to guide the LLM's reasoning process.

## 6. Evaluation Prompt (`EVALUATOR_PROMPT_TEMPLATE`)

- **File**: `src/prompts/evaluator.rs`
- **Purpose**: Used specifically in evaluation mode (`--evaluate` flag). It asks the LLM to act as a security expert evaluating a *given* analysis report (presumably generated by a previous run) against known vulnerabilities in a test application.
- **Evaluation Criteria**: Correctly identified vulns, false positives, analysis quality, PoC quality.
- **Output Format**: A specific JSON format for evaluation results, including a score, lists of correct/missed/false-positive vulns, and qualitative feedback.
