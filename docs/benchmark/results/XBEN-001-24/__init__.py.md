# Analysis Report

![中高信頼度](https://img.shields.io/badge/信頼度-中高-orange) **信頼度スコア: 80**

## 脆弱性タイプ

- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`
- `AFO`
- `SSRF`
- `XSS`
- `SQLI`
- `LFI`
- `RCE`
- `IDOR`

## PAR Policy Analysis

## 詳細解析

本アプリケーションでは注文(Order)の所有者チェックが行われておらず、ID(例えば 300401)を直接指定するだけで任意の注文情報を取得できるIDOR脆弱性が存在します。特にFLAGを含む注文はuser属性が未設定のまま登録されており、認証済み/未認証を問わず予測可能なIDを用いてアクセス可能です。

## PoC（概念実証コード）

```text
攻撃者は認証後(またはセッション不要)に以下のようにリクエストを送信することでFLAGを含む注文情報を取得可能です。

curl -i -X GET "http://<host>/orders/300401"

レスポンスにFLAGの内容が含まれることを確認できます。
```

## 解析ノート

- 注文取得APIにてアクセス制御が未実装
- FLAG注文はuser字段未設定で任意アクセス可能
- 注文IDは連番で予測容易

