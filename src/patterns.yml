# PAR Model Security Patterns
# Principal-Action-Resource unified patterns for Programming & IaC

Python:
  principals:
    - pattern: "async\\sdef\\s\\w+\\(.*?request"
      description: "HTTP request handlers (external input principal)"
    - pattern: "@app\\.route\\(.*?\\)"
      description: "Flask route decorators (web principal)"
    - pattern: "\\brequests\\."
      description: "HTTP requests library (external API principal)"
    - pattern: "\\bsocket\\."
      description: "Network socket operations (network principal)"
    - pattern: "urllib\\."
      description: "URL handling modules (web principal)"
    - pattern: "input\\s*\\("
      description: "User input function (user principal)"
    - pattern: "sys\\.argv"
      description: "Command line arguments (CLI principal)"
  
  actions:
    - pattern: "\\bhtml\\.escape\\s*\\("
      description: "HTML escaping action"
    - pattern: "\\bre\\.(match|search)\\s*\\("
      description: "Regex validation action"
    - pattern: "\\bbleach\\."
      description: "HTML sanitization action"
    - pattern: "\\bpydantic\\."
      description: "Data validation action"
    - pattern: "\\bwerkzeug\\.security\\."
      description: "Security utilities action"
    - pattern: "\\bhashlib\\."
      description: "Hash functions action"
    - pattern: "\\bos\\.path\\.(abspath|realpath)\\s*\\("
      description: "Path validation action"
  
  resources:
    - pattern: "\\bopen\\s*\\("
      description: "File operations resource"
    - pattern: "\\bsubprocess\\."
      description: "Process execution resource"
    - pattern: "\\bos\\.system\\s*\\("
      description: "System command execution resource"
    - pattern: "\\beval\\s*\\("
      description: "Code evaluation resource"
    - pattern: "\\bexec\\s*\\("
      description: "Code execution resource"
    - pattern: "\\.execute\\s*\\("
      description: "SQL execution resource"

JavaScript:
  principals:
    - pattern: "fetch\\(.*?\\)"
      description: "Fetch API requests (external principal)"
    - pattern: "XMLHttpRequest"
      description: "XMLHttpRequest API (external principal)"
    - pattern: "require\\s*\\("
      description: "Module imports (external principal)"
    - pattern: "process\\.env"
      description: "Environment variables (system principal)"
    - pattern: "document\\.(getElementById|querySelector)"
      description: "DOM access (user interface principal)"
  
  actions:
    - pattern: "\\bvalidator\\."
      description: "Validator.js library action"
    - pattern: "\\bDOMPurify\\."
      description: "DOM sanitization action"
    - pattern: "\\bescape-html"
      description: "HTML escaping action"
    - pattern: "\\bxss\\s*\\("
      description: "XSS filtering action"
    - pattern: "\\bhelmet\\."
      description: "Security middleware action"
    - pattern: "\\bbcrypt\\."
      description: "Password hashing action"
    - pattern: "\\.normalize\\s*\\("
      description: "Data normalization action"
  
  resources:
    - pattern: "\\beval\\s*\\("
      description: "Code evaluation resource"
    - pattern: "document\\.write\\s*\\("
      description: "Document write operations resource"
    - pattern: "\\.innerHTML\\s*="
      description: "HTML injection resource"
    - pattern: "child_process"
      description: "Process execution resource"
    - pattern: "fs\\.writeFile"
      description: "File writing resource"

# IaC Languages with same PAR structure

Terraform:
  principals:
    - pattern: "variable\\s+\"[^\"]*\"\\s*\\{"
      description: "Variable declarations (external input principal)"
    - pattern: "data\\s+\"[^\"]*\"\\s+\"[^\"]*\"\\s*\\{"
      description: "Data sources (external information principal)"
    - pattern: "module\\s+\"[^\"]*\"\\s*\\{"
      description: "Module declarations (external dependency principal)"
    - pattern: "provider\\s+\"[^\"]*\"\\s*\\{"
      description: "Provider configurations (cloud principal)"
    - pattern: "locals\\s*\\{"
      description: "Local value definitions (internal principal)"
    - pattern: "arn:aws:iam::[0-9]*:root"
      description: "AWS root account (external principal)"
    - pattern: "arn:aws:iam::[0-9]*:"
      description: "Cross-account access (external principal)"
  
  actions:
    - pattern: "validation\\s*\\{"
      description: "Input validation action"
    - pattern: "condition\\s*="
      description: "Validation conditions action"
    - pattern: "error_message\\s*="
      description: "Validation error messages action"
    - pattern: "sensitive\\s*=\\s*true"
      description: "Sensitive variable marking action"
    - pattern: "type\\s*=\\s*(string|number|bool|list|map|set|object|tuple)"
      description: "Type constraints action"
    - pattern: "encrypted\\s*=\\s*true"
      description: "Encryption enablement action"
    - pattern: "versioning.*enabled\\s*=\\s*true"
      description: "Versioning enablement action"
  
  resources:
    - pattern: "(password|secret|key|token)\\s*=\\s*\"[^\"]+\""
      description: "Hardcoded secrets resource"
    - pattern: "access_key\\s*=\\s*\"[^\"]+\""
      description: "Hardcoded AWS access keys resource"
    - pattern: "cidr_blocks\\s*=\\s*\\[\\s*\"0\\.0\\.0\\.0/0\"\\s*\\]"
      description: "Overly permissive network access resource"
    - pattern: "publicly_accessible\\s*=\\s*true"
      description: "Public database resource"
    - pattern: "encrypted\\s*=\\s*false"
      description: "Unencrypted storage resource"
    - pattern: "enable_logging\\s*=\\s*false"
      description: "Disabled logging resource"
    - pattern: "backup_retention_period\\s*=\\s*0"
      description: "No backup retention resource"
    - pattern: "deletion_protection\\s*=\\s*false"
      description: "No deletion protection resource"

Kubernetes:
  principals:
    - pattern: "kind:\\s*ServiceAccount"
      description: "Service account principal"
    - pattern: "kind:\\s*User"
      description: "User principal"
    - pattern: "kind:\\s*Group"
      description: "Group principal"
    - pattern: "system:masters"
      description: "Cluster admin principal"
    - pattern: "system:anonymous"
      description: "Anonymous access principal"
  
  actions:
    - pattern: "verbs:\\s*\\[.*\"\\*\".*\\]"
      description: "Wildcard permissions action"
    - pattern: "resources:\\s*\\[.*\"\\*\".*\\]"
      description: "All resources access action"
    - pattern: "apiGroups:\\s*\\[.*\"\\*\".*\\]"
      description: "All API groups access action"
    - pattern: "readOnlyRootFilesystem:\\s*true"
      description: "Read-only filesystem security action"
    - pattern: "runAsNonRoot:\\s*true"
      description: "Non-root execution security action"
  
  resources:
    - pattern: "privileged:\\s*true"
      description: "Privileged container resource"
    - pattern: "hostNetwork:\\s*true"
      description: "Host network access resource"
    - pattern: "hostPID:\\s*true"
      description: "Host PID access resource"
    - pattern: "containers:.*image:.*latest"
      description: "Latest tag container resource"
    - pattern: "type:\\s*LoadBalancer"
      description: "LoadBalancer service resource"

# Additional languages following same PAR pattern...

Rust:
  principals:
    - pattern: "async\\s+fn\\s+\\w+.*?Request"
      description: "HTTP request handlers principal"
    - pattern: "#\\[.*?route.*?\\]"
      description: "Route attributes principal"
    - pattern: "reqwest::"
      description: "HTTP client library principal"
    - pattern: "std::env::"
      description: "Environment variables principal"
  
  actions:
    - pattern: "\\bserde\\."
      description: "Serialization validation action"
    - pattern: "\\bvalidator\\."
      description: "Validation crate action"
    - pattern: "\\bregex\\."
      description: "Regex validation action"
    - pattern: "\\bammonia\\."
      description: "HTML sanitization action"
    - pattern: "\\bsha2::"
      description: "Hash functions action"
    - pattern: "\\bbcrypt::"
      description: "Password hashing action"
    - pattern: "\\bpath\\.canonicalize\\s*\\("
      description: "Path normalization action"
  
  resources:
    - pattern: "std::fs::write"
      description: "File writing resource"
    - pattern: "std::process::Command"
      description: "Process execution resource"
    - pattern: "\\.execute\\s*\\("
      description: "Database execution resource"

TypeScript:
  principals:
    - pattern: "app\\.(get|post|put|delete)\\(.*?\\)"
      description: "Express route handlers (web principal)"
    - pattern: "fetch\\(.*?\\)"
      description: "Fetch API requests (external API principal)"
    - pattern: "require\\s*\\("
      description: "Module imports (external principal)"
    - pattern: "process\\.env"
      description: "Environment variables (system principal)"
  
  actions:
    - pattern: "\\bvalidator\\."
      description: "Validator.js library action"
    - pattern: "\\bzod\\."
      description: "Schema validation action"
    - pattern: "\\byup\\."
      description: "Schema validation action"
    - pattern: "\\bDOMPurify\\."
      description: "DOM sanitization action"
    - pattern: "\\bhelmet\\."
      description: "Security middleware action"
    - pattern: "\\bbcrypt\\."
      description: "Password hashing action"
  
  resources:
    - pattern: "\\beval\\s*\\("
      description: "Code evaluation resource"
    - pattern: "document\\.write\\s*\\("
      description: "Document write operations resource"
    - pattern: "\\.innerHTML\\s*="
      description: "HTML injection resource"
    - pattern: "child_process"
      description: "Process execution resource"

Java:
  principals:
    - pattern: "HttpURLConnection"
      description: "HTTP URL connections (external principal)"
    - pattern: "\\bDriverManager\\.getConnection"
      description: "Database connections (external principal)"
    - pattern: "Scanner\\s*\\("
      description: "User input scanning (user principal)"
    - pattern: "System\\.getProperty"
      description: "System properties (system principal)"
  
  actions:
    - pattern: "\\bPattern\\."
      description: "Regex validation action"
    - pattern: "\\bValidator\\."
      description: "Bean validation action"
    - pattern: "\\bOWASP\\."
      description: "OWASP security action"
    - pattern: "\\bMessageDigest\\."
      description: "Hash functions action"
    - pattern: "\\bPaths\\.get\\s*\\("
      description: "Path validation action"
    - pattern: "\\bStringEscapeUtils\\."
      description: "String escaping action"
  
  resources:
    - pattern: "Runtime\\.exec"
      description: "Process execution resource"
    - pattern: "\\bStatement\\.execute"
      description: "SQL execution resource"
    - pattern: "\\bProcessBuilder"
      description: "Process building resource"

Go:
  principals:
    - pattern: "\\bhttp\\.HandleFunc\\s*\\("
      description: "HTTP handlers (web principal)"
    - pattern: "\\bnet\\.Dial\\s*\\("
      description: "Network dialing (network principal)"
    - pattern: "\\bsql\\.Open\\s*\\("
      description: "Database connections (external principal)"
    - pattern: "os\\.Args"
      description: "Command line arguments (CLI principal)"
  
  actions:
    - pattern: "\\bregexp\\."
      description: "Regex validation action"
    - pattern: "\\bvalidator\\."
      description: "Validation package action"
    - pattern: "\\bfilepaths\\.Clean\\s*\\("
      description: "Path cleaning action"
    - pattern: "\\bhtml\\.EscapeString\\s*\\("
      description: "HTML escaping action"
    - pattern: "\\bcrypto/"
      description: "Cryptographic operations action"
  
  resources:
    - pattern: "\\bexec\\.Command\\s*\\("
      description: "Command execution resource"
    - pattern: "\\bdb\\.Query\\s*\\("
      description: "Database queries resource"
    - pattern: "\\bos\\.Open\\s*\\("
      description: "File operations resource"

Ruby:
  principals:
    - pattern: "params\\["
      description: "Request parameters (web principal)"
    - pattern: "\\bActiveRecord::"
      description: "ActiveRecord ORM (external principal)"
    - pattern: "Net::HTTP"
      description: "HTTP client (network principal)"
    - pattern: "ARGV"
      description: "Command line arguments (CLI principal)"
  
  actions:
    - pattern: "\\bActiveModel::Validations"
      description: "Model validation action"
    - pattern: "\\bCGI\\.escapeHTML\\s*\\("
      description: "HTML escaping action"
    - pattern: "\\bRegexp\\."
      description: "Regex validation action"
    - pattern: "\\bBCrypt::"
      description: "Password hashing action"
    - pattern: "\\bPathname\\."
      description: "Path validation action"
    - pattern: "\\bSanitize\\."
      description: "HTML sanitization action"
  
  resources:
    - pattern: "\\beval\\s*\\("
      description: "Code evaluation resource"
    - pattern: "\\bsystem\\s*\\("
      description: "System commands resource"
    - pattern: "\\.execute\\s*\\("
      description: "Execution operations resource"
    - pattern: "\\bFile\\.open\\s*\\("
      description: "File operations resource"

C:
  principals:
    - pattern: "\\brecv\\s*\\("
      description: "Network receive operations (network principal)"
    - pattern: "\\baccept\\s*\\("
      description: "Socket accept operations (network principal)"
    - pattern: "\\bfgets\\s*\\("
      description: "File input operations (external principal)"
    - pattern: "\\bgetenv\\s*\\("
      description: "Environment variable access (system principal)"
    - pattern: "\\bargv\\["
      description: "Command line arguments (CLI principal)"
    - pattern: "\\bscanf\\s*\\("
      description: "Input scanning (user principal)"
    - pattern: "\\bgets\\s*\\("
      description: "Unsafe string input (user principal)"
  
  actions:
    - pattern: "\\bstrlen\\s*\\("
      description: "String length validation action"
    - pattern: "\\bisdigit\\s*\\("
      description: "Character validation action"
    - pattern: "\\bisalpha\\s*\\("
      description: "Character validation action"
    - pattern: "\\bstrnlen\\s*\\("
      description: "Safe string length action"
    - pattern: "\\bsnprintf\\s*\\("
      description: "Safe string formatting action"
    - pattern: "\\bstrncat\\s*\\("
      description: "Safe string concatenation action"
    - pattern: "\\bstrncpy\\s*\\("
      description: "Safe string copying action"
  
  resources:
    - pattern: "\\bsystem\\s*\\("
      description: "System command execution resource"
    - pattern: "\\bexec[lv]p?\\s*\\("
      description: "Process execution resource"
    - pattern: "\\bsprintf\\s*\\("
      description: "Unsafe string formatting resource"
    - pattern: "\\bstrcpy\\s*\\("
      description: "Unsafe string copying resource"
    - pattern: "\\bstrcat\\s*\\("
      description: "Unsafe string concatenation resource"
    - pattern: "\\bmalloc\\s*\\("
      description: "Memory allocation resource"
    - pattern: "\\bfree\\s*\\("
      description: "Memory deallocation resource"
    - pattern: "\\bprintf\\s*\\("
      description: "Format string operations resource"

Cpp:
  principals:
    - pattern: "std::cin"
      description: "Standard input operations (user principal)"
    - pattern: "\\bgetline\\s*\\("
      description: "Line input operations (user principal)"
    - pattern: "\\brecv\\s*\\("
      description: "Network receive operations (network principal)"
    - pattern: "\\baccept\\s*\\("
      description: "Socket accept operations (network principal)"
    - pattern: "std::getenv\\s*\\("
      description: "Environment variable access (system principal)"
    - pattern: "argc.*argv"
      description: "Command line arguments (CLI principal)"
    - pattern: "boost::asio"
      description: "Network I/O operations (network principal)"
  
  actions:
    - pattern: "std::regex"
      description: "Regular expression validation action"
    - pattern: "\\.empty\\s*\\(\\)"
      description: "Container emptiness check action"
    - pattern: "\\.size\\s*\\(\\)"
      description: "Container size validation action"
    - pattern: "std::isdigit\\s*\\("
      description: "Character validation action"
    - pattern: "std::isalpha\\s*\\("
      description: "Character validation action"
    - pattern: "boost::algorithm::trim"
      description: "String trimming action"
    - pattern: "std::clamp\\s*\\("
      description: "Value clamping action"
  
  resources:
    - pattern: "std::system\\s*\\("
      description: "System command execution resource"
    - pattern: "\\bexec[lv]p?\\s*\\("
      description: "Process execution resource"
    - pattern: "new\\s+"
      description: "Dynamic memory allocation resource"
    - pattern: "delete\\s+"
      description: "Memory deallocation resource"
    - pattern: "std::cout"
      description: "Standard output operations resource"
    - pattern: "printf\\s*\\("
      description: "C-style formatting resource"
    - pattern: "sprintf\\s*\\("
      description: "Unsafe string formatting resource"
    - pattern: "strcpy\\s*\\("
      description: "Unsafe string copying resource"